<!doctype html>
<html lang="mn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Play-Money Slot Demo</title>
  <style>
    body { font-family: system-ui, Arial, sans-serif; max-width: 480px; margin: 40px auto; }
    .reels { display:flex; gap:12px; justify-content:center; margin:16px 0; }
    .cell { width:90px; height:90px; border:1px solid #ccc; display:flex; align-items:center; justify-content:center; font-size:28px; }
    .controls { display:flex; gap:8px; justify-content:center; }
    .bank { text-align:center; margin:8px 0; }
    .log { font-size:14px; color:#555; min-height:18px; text-align:center; }
  </style>
</head>
<body>
  <h1>üé∞ Slot (Demo)</h1>
  <div class="bank">“Æ–ª–¥—ç–≥–¥—ç–ª: <span id="balance">1000</span> | –ú”©—Ä: <input id="bet" type="number" value="10" min="1" step="1" style="width:80px"></div>
  <div class="reels" id="reels"></div>
  <div class="controls">
    <button id="spin">SPIN</button>
    <button id="auto">AUTO (10)</button>
    <button id="reset">RESET</button>
  </div>
  <div class="log" id="log"></div>

  <script>
    // –°–∏–º–±–æ–ª –±–∞ –∂–∏–Ω (–∏–ª“Ø“Ø –∂–∏–Ω—Ç—ç–π –Ω—å –∏–ª“Ø“Ø –æ–ª–æ–Ω –¥–∞–≤—Ç–∞–º–∂—Ç–∞–π —Ç–∞–∞—Ä–Ω–∞)
    const symbols = [
      { s:"üçí", w:30, pay:2 },   // –±–∞–≥–∞ —Ç”©–ª–±”©—Ä, ”©–Ω–¥”©—Ä –¥–∞–≤—Ç–∞–º–∂
      { s:"üçã", w:25, pay:3 },
      { s:"üîî", w:18, pay:5 },
      { s:"‚≠ê",  w:12, pay:10 },
      { s:"üíé", w:8,  pay:20 },  // ”©–Ω–¥”©—Ä —Ç”©–ª–±”©—Ä, –±–∞–≥–∞ –¥–∞–≤—Ç–∞–º–∂
      { s:"7Ô∏è‚É£", w:5,  pay:50 }   // jackpot —Ç”©—Ä–ª–∏–π–Ω
    ];

    // –ñ–∏–Ω–≥—ç—ç—Å –∂–∏–Ω–ª—ç—Å—ç–Ω —Å–∞–Ω–∞–º—Å–∞—Ä–≥“Ø–π —Å–æ–Ω–≥–æ–ª—Ç
    function pickWeighted(list){
      const total = list.reduce((a,b)=>a+b.w,0);
      let r = Math.random()*total;
      for(const item of list){
        if((r -= item.w) <= 0) return item;
      }
      return list[list.length-1];
    }

    // –¢–æ–≥–ª–æ–≥—á–∏–π–Ω –±–∞–Ω–∫—Ä–æ–ª–ª
    let balance = 1000;
    const reelsDiv = document.getElementById('reels');
    const balanceEl = document.getElementById('balance');
    const betEl = document.getElementById('bet');
    const logEl = document.getElementById('log');

    function render(roll){
      reelsDiv.innerHTML = '';
      roll.forEach(row=>{
        const cell = document.createElement('div');
        cell.className = 'cell';
        cell.textContent = row.s;
        reelsDiv.appendChild(cell);
      });
    }

    function spinOnce(bet){
      if (bet < 1) { log('–ú”©—Ä —Ö–∞–º–≥–∏–π–Ω –±–∞–≥–∞–¥–∞–∞ 1'); return; }
      if (balance < bet) { log('“Æ–ª–¥—ç–≥–¥—ç–ª —Ö“Ø—Ä—ç–ª—Ü—ç—Ö–≥“Ø–π'); return; }

      balance -= bet;

      // 3 –º”©—Ä—Ç—ç–π, —Ç—É—Å –±“Ø—Ä 1 —Å–∏–º–≤–æ–ª (—ç–Ω–∏–π–≥ 3x3 –±–æ–ª–≥–æ–∂ —Ç—ç–ª–∂ –±–æ–ª–Ω–æ)
      const roll = [pickWeighted(symbols), pickWeighted(symbols), pickWeighted(symbols)];
      render(roll);

      // –¢”©–ª–±”©—Ä–∏–π–Ω –¥“Ø—Ä—ç–º: 3 –∏–∂–∏–ª = bet * pay, 2 –∏–∂–∏–ª = bet * (pay/2)
      let payout = 0;
      const [a,b,c] = roll.map(r=>r.s);
      if (a===b && b===c){
        const pay = symbols.find(x=>x.s===a).pay;
        payout = Math.floor(bet * pay);
        balance += payout;
        log(`üéâ 3 –∏–∂–∏–ª! –¢”©–ª–±”©—Ä: +${payout}`);
      } else if (a===b || b===c || a===c){
        const match = a===b ? a : (b===c ? b : a);
        const pay = symbols.find(x=>x.s===match).pay;
        payout = Math.floor(bet * Math.max(1, Math.round(pay/2)));
        balance += payout;
        log(`‚ú® 2 –∏–∂–∏–ª! –¢”©–ª–±”©—Ä: +${payout}`);
      } else {
        log('üòó –•–æ–æ—Å–æ–Ω —ç—Ä–≥—ç–ª—Ç');
      }

      balanceEl.textContent = balance;
    }

    function log(msg){ logEl.textContent = msg; }

    // –≠—Ö —Ä—ç–Ω–¥—ç—Ä
    render([{s:"‚ùî"},{s:"‚ùî"},{s:"‚ùî"}]);
    balanceEl.textContent = balance;

    // –¢–æ–≤—á–ª—É—É—Ä—É—É–¥
    document.getElementById('spin').onclick = ()=>{
      const bet = parseInt(betEl.value,10) || 1;
      spinOnce(bet);
    };

    document.getElementById('reset').onclick = ()=>{
      balance = 1000;
      balanceEl.textContent = balance;
      render([{s:"‚ùî"},{s:"‚ùî"},{s:"‚ùî"}]);
      log('–®–∏–Ω—ç—ç—Ä —ç—Ö—ç–ª–ª—ç—ç');
    };

    document.getElementById('auto').onclick = async ()=>{
      let n = 10;
      const bet = parseInt(betEl.value,10) || 1;
      while(n-- > 0 && balance >= bet){
        spinOnce(bet);
        await new Promise(r=>setTimeout(r, 300));
      }
    };
  </script>
</body>
</html>
